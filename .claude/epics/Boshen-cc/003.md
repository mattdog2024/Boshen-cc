---
name: 波神11线算法实现
status: open
created: 2025-10-28T08:08:33Z
updated: 2025-10-28T08:08:33Z
github: [Will be updated when synced to GitHub]
depends_on: [001]
parallel: true
conflicts_with: [002]
---

# Task: 波神11线算法实现

## Description
基于波神11线精确算法文档，实现高精度的预测线计算逻辑，确保与原版软件的计算结果误差小于0.1%。

## Acceptance Criteria
- [ ] 实现波神11线标准比例数组：[0.0, 1.0, 1.849, 2.397, 3.137, 3.401, 4.000, 4.726, 5.247, 6.027, 6.808]
- [ ] 开发BoshenAlgorithmService核心计算服务
- [ ] 实现基于A点(最低价)和B点(最高价)的11线精确计算
- [ ] 创建PredictionLine数据模型，包含线名、价格、比例信息
- [ ] 实现计算结果验证和精度校验功能
- [ ] 添加价格标签生成功能，格式化显示每条线对应的价格
- [ ] 算法精度达到与原版软件误差<0.1%

## Technical Details
- **核心算法**:
  ```csharp
  public List<PredictionLine> CalculatePredictionLines(KLineInfo kLine)
  {
      var lines = new List<PredictionLine>();
      double range = kLine.HighPrice - kLine.LowPrice;

      for (int i = 0; i < BOSHEN_RATIOS.Length; i++)
      {
          double price;
          if (i == 0) // A线
              price = kLine.LowPrice;
          else
              price = kLine.HighPrice + range * (BOSHEN_RATIOS[i] - 1);

          lines.Add(new PredictionLine
          {
              Name = LINE_NAMES[i],
              Price = Math.Round(price, 2),
              Ratio = BOSHEN_RATIOS[i]
          });
      }
      return lines;
  }
  ```
- **数据模型**:
  ```csharp
  public class PredictionLine
  {
      public string Name { get; set; }  // A线, B线, 1线...极线
      public double Price { get; set; } // 计算出的价格
      public double Ratio { get; set; } // 波神比例
      public bool IsImportant { get; set; } // 3线、6线、8线为重点线
  }
  ```

## Dependencies
- [ ] 任务001: 项目基础架构
- [ ] 波神算法文档验证完成
- [ ] KLineInfo数据模型定义

## Effort Estimate
- Size: M
- Hours: 24
- Parallel: true

## Definition of Done
- [ ] 单元测试包含所有11条线的计算验证
- [ ] 与文档中的测试案例对比精度验证通过
- [ ] 算法性能测试达标(<10ms)
- [ ] 异常输入处理完善
- [ ] 代码注释详细，算法逻辑清晰